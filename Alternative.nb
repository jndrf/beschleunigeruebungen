(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27808,        694]
NotebookOptionsPosition[     23813,        622]
NotebookOutlinePosition[     24155,        637]
CellTagsIndexPosition[     24112,        634]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"CoordinateChartData", "[", 
  RowBox[{"{", "\"\<Cylindrical\>\"", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7378294416969805`*^9, 3.7378294454471397`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"a1fb624f-11a2-4080-9755-e39872367d9d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Cylindrical\"\>", ",", "\<\"Euclidean\"\>", ",", "3"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.737829445870706*^9, 3.7378296611666594`*^9, 3.7378299415550427`*^9, 
   3.7378302433475175`*^9, 3.7378304110486603`*^9, 3.737831297669526*^9, 
   3.737831364399908*^9, 3.737831475000247*^9, 3.737831530626379*^9, {
   3.737832986391797*^9, 3.7378330059518013`*^9}, 3.7378358597597914`*^9, 
   3.737836631893084*^9, 3.737840100575243*^9, 3.7378401553882256`*^9, 
   3.737840493067009*^9, 3.7378406933003445`*^9, {3.737840731677111*^9, 
   3.737840750753609*^9}, 3.737840914728371*^9, 3.737841724720729*^9, {
   3.7378423404882154`*^9, 3.737842362088133*^9}, {3.7378423939815397`*^9, 
   3.7378424195074425`*^9}, 3.7378426908660164`*^9, 3.737842917411868*^9, 
   3.737843181924469*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"39d493fd-0df9-4f4c-8946-b9b54520e0c0"]
}, Open  ]],

Cell["Berechne E-Feld", "Text",
 CellChangeTimes->{{3.737830204418316*^9, 
  3.737830211906665*^9}},ExpressionUUID->"c214aab0-0597-482e-8408-\
04c5d3d8744f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]", "[", "r_", "]"}], ":=", 
  RowBox[{"e", "*", "ns"}]}]], "Input",
 CellChangeTimes->{{3.737829650539524*^9, 3.7378296574424667`*^9}, 
   3.7378299370266724`*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"78049c20-8945-4679-bba1-8d2e399af16d"],

Cell[BoxData[
 RowBox[{"lefte", ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"r", "*", "eField"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", 
        RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", "0", ",", "l"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7378293659244432`*^9, 3.7378294578914175`*^9}, 
   3.737830229875291*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"5e0a102c-8b27-4dad-9340-af32a9623496"],

Cell[BoxData[
 RowBox[{"righte", ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "\[Epsilon]"], "*", "r", "*", "\[Rho]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "0", ",", "l"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", 
        RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "0", ",", "r"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.737829464947204*^9, 3.7378295616344132`*^9}, {
   3.737829646324833*^9, 3.7378296473787684`*^9}, 3.7378302316025267`*^9, {
   3.737830332772683*^9, 3.7378303857804923`*^9}, {3.737831286998436*^9, 
   3.7378312874759474`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"e22b6d79-046d-4a7c-ab61-757200158e38"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ef", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"lefte", "\[Equal]", "righte"}], ",", "eField"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.737829604915167*^9, 3.7378296127711353`*^9}, {
   3.737829663619153*^9, 3.7378296653164167`*^9}, {3.737829946643841*^9, 
   3.73782997320369*^9}, 3.7378301676988544`*^9, {3.7378302353307133`*^9, 
   3.737830236450568*^9}, {3.7378310902755504`*^9, 3.737831091523275*^9}, {
   3.7378313037962637`*^9, 3.7378313397005577`*^9}, {3.7378314679404645`*^9, 
   3.7378314694289427`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"938c221d-01e4-4f5d-a149-0eb3c3fd2894"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"eField", "\[Rule]", 
   FractionBox[
    RowBox[{"r", " ", "\[Rho]"}], 
    RowBox[{"2", " ", "\[Epsilon]"}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.737829613023877*^9, {3.7378296612645597`*^9, 3.7378296685940666`*^9}, 
   3.7378299416579385`*^9, 3.737829974459404*^9, 3.7378301685539837`*^9, 
   3.737830243431432*^9, 3.7378304111395674`*^9, 3.7378310917560368`*^9, {
   3.7378312904459124`*^9, 3.7378312977604337`*^9}, {3.7378313429162703`*^9, 
   3.737831364500805*^9}, 3.737831475089156*^9, 3.7378315307452574`*^9, {
   3.7378329864986877`*^9, 3.737833006102646*^9}, 3.737835859891656*^9, 
   3.737836632026946*^9, 3.7378401007600546`*^9, 3.737840155475154*^9, 
   3.7378404931629276`*^9, 3.7378406933972454`*^9, {3.7378407317660203`*^9, 
   3.7378407508395367`*^9}, 3.7378409148342457`*^9, 3.737841724834612*^9, {
   3.737842340603098*^9, 3.737842362185034*^9}, {3.7378423940834236`*^9, 
   3.7378424196423116`*^9}, 3.7378426909998794`*^9, 3.7378429175087695`*^9, 
   3.7378431820293446`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"262b0956-a737-4995-9973-2a1bc9d1819b"]
}, Open  ]],

Cell["Berechne B-Feld", "Text",
 CellChangeTimes->{{3.7378302171702814`*^9, 
  3.7378302200823092`*^9}},ExpressionUUID->"63b32c19-ee8e-4af9-98bf-\
5467c1c501bc"],

Cell[BoxData[
 RowBox[{"leftb", ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"r", "*", "bField"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "0", ",", 
      RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.737830246195608*^9, 3.7378302941951227`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"e415a441-25e4-4518-9242-78e65170e5f9"],

Cell[BoxData[
 RowBox[{"rightb", ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"\[Mu]", "*", "r", "*", "j"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", 
        RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "0", ",", "r"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7378302972050576`*^9, 3.7378303042758327`*^9}, {
  3.737830416195399*^9, 3.737830423507923*^9}, {3.7378305997157917`*^9, 
  3.737830651602747*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"30272dab-b1c9-426f-92b9-fbaf4958b4e2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bf", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"leftb", "\[Equal]", "rightb"}], ",", "bField"}], "]"}], "//.", 
     RowBox[{"j", "\[Rule]", " ", 
      RowBox[{"\[Rho]", "*", "\[Beta]", "*", "c"}]}]}], "//.", 
    RowBox[{"\[Mu]", "\[Rule]", " ", 
     FractionBox["1", 
      RowBox[{"\[Epsilon]", "*", 
       SuperscriptBox["c", "2"]}]]}]}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.7378307531239595`*^9, 3.7378307686440926`*^9}, {
   3.7378309427723465`*^9, 3.7378309613463774`*^9}, {3.737830999540311*^9, 
   3.737831001012806*^9}, {3.7378310986439953`*^9, 3.737831099107521*^9}, {
   3.7378312933489437`*^9, 3.7378312939713073`*^9}, 3.7378313595262995`*^9, 
   3.737831465428033*^9, {3.737831513684699*^9, 3.7378315268522377`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"162167b6-f220-40e0-bc58-9d2031b8b37e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"bField", "\[Rule]", 
   FractionBox[
    RowBox[{"r", " ", "\[Beta]", " ", "\[Rho]"}], 
    RowBox[{"2", " ", "c", " ", "\[Epsilon]"}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.737830769233491*^9, 3.737830961799894*^9, 3.7378310012445683`*^9, 
   3.7378310996899376`*^9, 3.7378312977943993`*^9, {3.737831360271538*^9, 
   3.7378313645527515`*^9}, 3.7378314751281166`*^9, 3.737831530783219*^9, {
   3.737832986537648*^9, 3.737833006172575*^9}, 3.737835859927619*^9, 
   3.7378366320629096`*^9, 3.737840100799014*^9, 3.7378401555171056`*^9, 
   3.7378404931978874`*^9, 3.7378406934392166`*^9, {3.7378407318109865`*^9, 
   3.7378407508834753`*^9}, 3.737840914875204*^9, 3.737841724878579*^9, {
   3.737842340650049*^9, 3.737842362219999*^9}, {3.7378423941184034`*^9, 
   3.7378424196832523`*^9}, 3.7378426910358424`*^9, 3.7378429175567303`*^9, 
   3.7378431820673122`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"704ff795-4f6b-40d1-b8c7-78a65c806f6f"]
}, Open  ]],

Cell["Berechne Lorentzkraft", "Text",
 CellChangeTimes->{{3.7378330158117228`*^9, 
  3.7378330193481073`*^9}},ExpressionUUID->"cd4ce4f6-648f-4779-a44c-\
9be28e30d54a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fLorentz", "[", "r_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"e", "*", 
    RowBox[{"(", 
     RowBox[{"eField", "+", 
      RowBox[{"\[Beta]", "*", "c", "*", "bField"}]}], ")"}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.7378310323887434`*^9, 3.7378311125018277`*^9}, {
  3.737831196116347*^9, 3.7378311970114374`*^9}, {3.737831375508551*^9, 
  3.737831377763246*^9}, {3.7378314421659937`*^9, 3.7378314422608967`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"eb143888-9ca1-4e8a-86eb-eaaa34c2c616"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fLorentz", "[", "r", "]"}], "//.", "ef"}], "//.", "bf"}], "//.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Beta]", "2"]}], ")"}], "\[Rule]", " ", 
    FractionBox["1", 
     SuperscriptBox["\[Gamma]", "2"]]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7378311139083896`*^9, 3.737831133524336*^9}, {
  3.737831168308775*^9, 3.737831209461704*^9}, {3.7378329643413377`*^9, 
  3.737832977732647*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"8d5b0347-71cf-4a25-b401-fea3ecdb0a38"],

Cell[BoxData[
 FractionBox[
  RowBox[{"e", " ", "r", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[Beta]", "2"]}], ")"}], " ", "\[Rho]"}], 
  RowBox[{"2", " ", "\[Epsilon]"}]]], "Output",
 CellChangeTimes->{{3.737831117453765*^9, 3.7378311337511044`*^9}, {
   3.737831169989057*^9, 3.7378312097224503`*^9}, 3.7378312978533382`*^9, {
   3.737831364623679*^9, 3.7378313793076696`*^9}, 3.737831443496634*^9, 
   3.73783147518306*^9, 3.737831530846154*^9, {3.7378329802860374`*^9, 
   3.7378330062345114`*^9}, 3.737835859995549*^9, 3.737836632138832*^9, 
   3.737840100871956*^9, 3.73784015559103*^9, 3.7378404932728024`*^9, 
   3.737840693511167*^9, {3.7378407318709507`*^9, 3.7378407509464245`*^9}, 
   3.7378409149611173`*^9, 3.7378417249365115`*^9, {3.737842340710989*^9, 
   3.737842362294958*^9}, {3.737842394186318*^9, 3.737842419750184*^9}, 
   3.737842691108796*^9, 3.7378429176296577`*^9, 3.737843182146224*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"cd5288ed-905b-472d-ba5d-2d86ddcbbde1"]
}, Open  ]],

Cell["Quadropolst\[ADoubleDot]rke", "Text",
 CellChangeTimes->{{3.7378348430490637`*^9, 
  3.7378348650945153`*^9}},ExpressionUUID->"d685a21e-3c04-4851-b75d-\
f2c45103365b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", "=", " ", 
  RowBox[{"-", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"bField", "//.", "bf"}], " ", ",", " ", "r"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.73778414963698*^9, 3.737784194912979*^9}, {
  3.737825123472046*^9, 3.73782514223886*^9}, {3.7378423319349594`*^9, 
  3.73784235815915*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"3dd5765b-5d33-4f09-a9f4-de94037d8093"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[Beta]", " ", "\[Rho]"}], 
   RowBox[{"2", " ", "c", " ", "\[Epsilon]"}]]}]], "Output",
 CellChangeTimes->{{3.7378423407269707`*^9, 3.737842362311921*^9}, {
   3.73784239420431*^9, 3.7378424197661777`*^9}, 3.7378426911287475`*^9, 
   3.737842917648631*^9, 3.7378431821642065`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"b99ed202-83af-4368-aa6e-a646ae1acaec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kdef", " ", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"q", "*", "c"}], 
     RowBox[{"\[Beta]", "*", "energy"}]], "*", "g"}], "//.", 
   RowBox[{"energy", "\[Rule]", " ", 
    RowBox[{"m0", "*", 
     SuperscriptBox["c", "2"], "*", "\[Gamma]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.737784204877008*^9, 3.7377842182814813`*^9}, {
  3.7377845643140774`*^9, 3.737784577801609*^9}, {3.7378426173611617`*^9, 
  3.7378426252311163`*^9}, {3.737842672095206*^9, 3.7378426778243494`*^9}, {
  3.7378429114249887`*^9, 3.737842911598811*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"575a26d0-52d2-4558-b672-5ab5ad29ca8f"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"q", " ", "\[Rho]"}], 
   RowBox[{"2", " ", 
    SuperscriptBox["c", "2"], " ", "m0", " ", "\[Gamma]", " ", 
    "\[Epsilon]"}]]}]], "Output",
 CellChangeTimes->{{3.7378423407559414`*^9, 3.737842362339881*^9}, {
   3.7378423942322717`*^9, 3.7378424197831607`*^9}, {3.7378426793308086`*^9, 
   3.7378426911457305`*^9}, 3.737842917667617*^9, 3.7378431821831865`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"72282431-1d0d-4f1c-9318-4f8d81922ed0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kalt", "=", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{"e", "*", "i"}], 
    RowBox[{"2", "*", "Pi", "*", "\[Epsilon]", "*", "m0", "*", 
     SuperscriptBox["a", "2"], "*", 
     SuperscriptBox["\[Beta]", "3"], "*", 
     SuperscriptBox["c", "3"], "*", 
     SuperscriptBox["\[Gamma]", "3"]}]]}]}]], "Input",
 CellChangeTimes->{{3.737842858369244*^9, 3.7378428995191607`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"3952e75f-65a1-4138-b683-588746f2220f"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"e", " ", "i"}], 
   RowBox[{"2", " ", 
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox["c", "3"], " ", "m0", " ", "\[Pi]", " ", 
    SuperscriptBox["\[Beta]", "3"], " ", 
    SuperscriptBox["\[Gamma]", "3"], " ", "\[Epsilon]"}]]}]], "Output",
 CellChangeTimes->{{3.737842900393279*^9, 3.7378429176865883`*^9}, 
   3.7378431822051744`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"5e3e2fe6-7916-49a1-9c39-2d10015689d5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mQ", "[", "l_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "0"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"k", "*", "l"}], ")"}]}], ",", " ", "1"}], "}"}]}], "}"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.7377851097466145`*^9, 3.737785162701046*^9}, {
   3.7378361534165783`*^9, 3.737836156568362*^9}, {3.737840485725514*^9, 
   3.7378404873568463`*^9}, 3.7378406887809772`*^9, {3.7378407453741083`*^9, 
   3.7378407455659122`*^9}, 3.737842318767421*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"0ec4b5cc-dd49-4204-8b91-7725f158e48a"],

Cell[BoxData[
 RowBox[{"twissMat", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "\[Mu]0", "]"}], "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "0"}], "}"}], 
      StyleBox[",",
       FontWeight->"Plain"], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      StyleBox[
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "1"}], "}"}],
       FontWeight->"Plain"]}], 
     StyleBox["}",
      FontWeight->"Plain"]}]}], 
   StyleBox[" ",
    FontWeight->"Plain"], 
   StyleBox["+",
    FontWeight->"Plain"], 
   StyleBox[" ",
    FontWeight->"Plain"], 
   RowBox[{
    RowBox[{"Sin", "[", "\[Mu]0", "]"}], "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", " ", 
        SubscriptBox["\[Beta]", "t"]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], ",", " ", 
        RowBox[{"-", "\[Alpha]"}]}], "}"}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7378349248404465`*^9, 3.737834944983843*^9}, {
  3.737840896366126*^9, 3.737840903549782*^9}, {3.7378423829587965`*^9, 
  3.7378423894221888`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"364b73c5-59a3-49ea-ae34-16a424f75ec1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"disturbedMat", "=", 
  RowBox[{
   RowBox[{"twissMat", ".", 
    RowBox[{"mQ", "[", "ds", "]"}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.73783503944827*^9, 3.737835042230425*^9}, {
  3.737835076902979*^9, 3.737835101448885*^9}, {3.7378351324881535`*^9, 
  3.7378351327908435`*^9}, {3.7378362189695625`*^9, 3.7378362288244877`*^9}, {
  3.7378407687166376`*^9, 3.737840803180397*^9}, {3.737840907422823*^9, 
  3.7378409078693657`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"32fb6a70-894c-4fa9-a270-04beb4f39186"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Mu]0", "]"}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Mu]0", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Alpha]", "-", 
         RowBox[{"ds", " ", "k", " ", 
          SubscriptBox["\[Beta]", "t"]}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Mu]0", "]"}], " ", 
      SubscriptBox["\[Beta]", "t"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "ds"}], " ", "k", " ", 
       RowBox[{"Cos", "[", "\[Mu]0", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ds", " ", "k", " ", "\[Alpha]"}], "-", "\[Gamma]"}], ")"}], 
       " ", 
       RowBox[{"Sin", "[", "\[Mu]0", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Mu]0", "]"}], "-", 
      RowBox[{"\[Alpha]", " ", 
       RowBox[{"Sin", "[", "\[Mu]0", "]"}]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7378350940644464`*^9, 3.737835101644685*^9}, 
   3.7378351336819324`*^9, 3.7378358600504932`*^9, 3.7378361588350563`*^9, {
   3.7378362205789185`*^9, 3.7378362304158773`*^9}, 3.7378366321757936`*^9, 
   3.737840100946863*^9, 3.7378401556779413`*^9, 3.737840493350729*^9, 
   3.737840693584055*^9, {3.737840731911871*^9, 3.737840803415152*^9}, 
   3.737840915085988*^9, 3.737841725058395*^9, {3.7378423417768974`*^9, 
   3.737842363041174*^9}, {3.737842394695797*^9, 3.737842420253669*^9}, 
   3.7378426920098624`*^9, 3.737842917804467*^9, 3.737843182328038*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"1f7e68b2-7b58-47a3-88e1-c7416ae5169b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[Mu]", "]"}], "\[Equal]", 
     RowBox[{
      FractionBox["1", "2"], "*", 
      RowBox[{"Tr", "[", "disturbedMat", "]"}]}]}], "//.", 
    RowBox[{"\[Mu]", "\[Rule]", " ", 
     RowBox[{"\[Delta]\[Mu]", "+", "\[Mu]0"}]}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.7378408331667356`*^9, 3.73784086279646*^9}, {
   3.737840920510458*^9, 3.7378409280767097`*^9}, {3.737840998702505*^9, 
   3.7378410065115223`*^9}, {3.7378410506863613`*^9, 3.7378410736289234`*^9}, 
   3.7378412036469855`*^9, 3.7378415350232124`*^9, {3.7378419311516895`*^9, 
   3.7378419400945473`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"d0c5fc0d-376d-4437-a5a6-3147dfe1195a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"\[Delta]\[Mu]", "+", "\[Mu]0"}], "]"}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", "ds", " ", "k", " ", 
    RowBox[{"Sin", "[", "\[Mu]0", "]"}], " ", 
    SubscriptBox["\[Beta]", "t"]}]}], "\[Equal]", 
  RowBox[{"Cos", "[", "\[Mu]0", "]"}]}]], "Output",
 CellChangeTimes->{
  3.7378408658173676`*^9, {3.737840915100973*^9, 3.7378409287580256`*^9}, 
   3.737841006782257*^9, {3.737841063588171*^9, 3.7378410741064315`*^9}, 
   3.7378412162520995`*^9, 3.7378415354078197`*^9, 3.7378417251952553`*^9, 
   3.7378419404341993`*^9, {3.737842348236294*^9, 3.737842420835087*^9}, 
   3.737842699080618*^9, 3.7378429179722953`*^9, 3.7378431824908886`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"db86fab3-cd84-4838-8dc5-ce81f2dc5d1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{"eq", ",", 
     RowBox[{"{", 
      RowBox[{"\[Delta]\[Mu]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Normal"}]}]], "Input",
 CellChangeTimes->{{3.7378419439676037`*^9, 3.7378420378705883`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"5c852bfc-8bdc-430c-945e-5e2cfcc11c78"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", "\[Mu]0", "]"}], "-", 
   RowBox[{"\[Delta]\[Mu]", " ", 
    RowBox[{"Sin", "[", "\[Mu]0", "]"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", "ds", " ", "k", " ", 
    RowBox[{"Sin", "[", "\[Mu]0", "]"}], " ", 
    SubscriptBox["\[Beta]", "t"]}]}], "\[Equal]", 
  RowBox[{"Cos", "[", "\[Mu]0", "]"}]}]], "Output",
 CellChangeTimes->{{3.737841959116101*^9, 3.7378420383281336`*^9}, {
   3.737842348374153*^9, 3.737842420920005*^9}, 3.737842699213482*^9, 
   3.737842918029254*^9, 3.737843182550811*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"60e44220-9950-4895-aa2e-7e7f37b0f704"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phaseshift", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{"solution", ",", "\[Delta]\[Mu]"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.737842040430971*^9, 3.737842046798461*^9}, {
  3.7378421074714427`*^9, 3.7378421383838315`*^9}, {3.7378431268647404`*^9, 
  3.7378431322082853`*^9}, {3.7378431693433228`*^9, 3.7378431733452387`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"b073be11-f5b4-4681-82bb-5c849758f7c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Delta]\[Mu]", "\[Rule]", 
   RowBox[{
    FractionBox["1", "2"], " ", "ds", " ", "k", " ", 
    SubscriptBox["\[Beta]", "t"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7378420474457994`*^9, {3.7378421118439646`*^9, 3.737842138563659*^9}, {
   3.7378423483941326`*^9, 3.737842420940966*^9}, 3.7378426992324624`*^9, 
   3.7378429180482283`*^9, 3.73784313253794*^9, 3.737843182570791*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"8caabe53-5477-4c69-baea-f49bb159b9b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tuneshift", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        FractionBox["\[Delta]\[Mu]", 
         RowBox[{"2", "*", "Pi"}]], "//.", "phaseshift"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", "l"}], "}"}]}], "]"}], "//.", 
     RowBox[{"ds", "\[Rule]", " ", "1"}]}], "//.", 
    RowBox[{"k", "\[Rule]", " ", "kalt"}]}], "//.", 
   RowBox[{"a", "\[Rule]", 
    RowBox[{"Sqrt", "[", " ", 
     RowBox[{
      SubscriptBox["\[Epsilon]", "t"], "*", 
      SubscriptBox["\[Beta]", "t"]}], "]"}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "keine", " ", "Ahnung", " ", "was", " ", "ich", " ", "hier", " ", 
       "tue"}], "..."}], "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7378421417274227`*^9, 3.737842196095831*^9}, {
  3.7378422394555035`*^9, 3.73784225783871*^9}, {3.7378431643534145`*^9, 
  3.737843272207158*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"2d755497-6302-47ee-985f-241e652c6f37"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"e", " ", "i", " ", "l"}], 
   RowBox[{"8", " ", 
    SuperscriptBox["c", "3"], " ", "m0", " ", 
    SuperscriptBox["\[Pi]", "2"], " ", 
    SuperscriptBox["\[Beta]", "3"], " ", 
    SuperscriptBox["\[Gamma]", "3"], " ", "\[Epsilon]", " ", 
    SubscriptBox["\[Epsilon]", "t"]}]]}]], "Output",
 CellChangeTimes->{
  3.737842239897052*^9, {3.737842348411115*^9, 3.7378424209549646`*^9}, 
   3.737842699247448*^9, 3.7378429180632124`*^9, {3.737843164840933*^9, 
   3.7378432155271034`*^9}, {3.7378432497111564`*^9, 3.7378432726447115`*^9}},
 CellLabel->"Out[25]=",ExpressionUUID->"a9199d24-2e53-4e92-91d4-bb04147ff4ca"]
}, Open  ]]
},
WindowSize->{958, 1028},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 261, 4, 28, "Input",ExpressionUUID->"a1fb624f-11a2-4080-9755-e39872367d9d"],
Cell[844, 28, 905, 15, 32, "Output",ExpressionUUID->"39d493fd-0df9-4f4c-8946-b9b54520e0c0"]
}, Open  ]],
Cell[1764, 46, 157, 3, 34, "Text",ExpressionUUID->"c214aab0-0597-482e-8408-04c5d3d8744f"],
Cell[1924, 51, 282, 6, 28, "Input",ExpressionUUID->"78049c20-8945-4679-bba1-8d2e399af16d"],
Cell[2209, 59, 545, 14, 28, "Input",ExpressionUUID->"5e0a102c-8b27-4dad-9340-af32a9623496"],
Cell[2757, 75, 884, 21, 51, "Input",ExpressionUUID->"e22b6d79-046d-4a7c-ab61-757200158e38"],
Cell[CellGroupData[{
Cell[3666, 100, 668, 13, 28, "Input",ExpressionUUID->"938c221d-01e4-4f5d-a149-0eb3c3fd2894"],
Cell[4337, 115, 1121, 19, 54, "Output",ExpressionUUID->"262b0956-a737-4995-9973-2a1bc9d1819b"]
}, Open  ]],
Cell[5473, 137, 161, 3, 34, "Text",ExpressionUUID->"63b32c19-ee8e-4af9-98bf-5467c1c501bc"],
Cell[5637, 142, 384, 9, 28, "Input",ExpressionUUID->"e415a441-25e4-4518-9242-78e65170e5f9"],
Cell[6024, 153, 629, 15, 28, "Input",ExpressionUUID->"30272dab-b1c9-426f-92b9-fbaf4958b4e2"],
Cell[CellGroupData[{
Cell[6678, 172, 910, 19, 53, "Input",ExpressionUUID->"162167b6-f220-40e0-bc58-9d2031b8b37e"],
Cell[7591, 193, 991, 17, 56, "Output",ExpressionUUID->"704ff795-4f6b-40d1-b8c7-78a65c806f6f"]
}, Open  ]],
Cell[8597, 213, 167, 3, 34, "Text",ExpressionUUID->"cd4ce4f6-648f-4779-a44c-9be28e30d54a"],
Cell[8767, 218, 539, 12, 28, "Input",ExpressionUUID->"eb143888-9ca1-4e8a-86eb-eaaa34c2c616"],
Cell[CellGroupData[{
Cell[9331, 234, 603, 15, 55, "Input",ExpressionUUID->"8d5b0347-71cf-4a25-b401-fea3ecdb0a38"],
Cell[9937, 251, 1019, 17, 59, "Output",ExpressionUUID->"cd5288ed-905b-472d-ba5d-2d86ddcbbde1"]
}, Open  ]],
Cell[10971, 271, 173, 3, 34, "Text",ExpressionUUID->"d685a21e-3c04-4851-b75d-f2c45103365b"],
Cell[CellGroupData[{
Cell[11169, 278, 417, 10, 28, "Input",ExpressionUUID->"3dd5765b-5d33-4f09-a9f4-de94037d8093"],
Cell[11589, 290, 416, 8, 56, "Output",ExpressionUUID->"b99ed202-83af-4368-aa6e-a646ae1acaec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12042, 303, 657, 14, 52, "Input",ExpressionUUID->"575a26d0-52d2-4558-b672-5ab5ad29ca8f"],
Cell[12702, 319, 498, 10, 57, "Output",ExpressionUUID->"72282431-1d0d-4f1c-9318-4f8d81922ed0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13237, 334, 481, 11, 56, "Input",ExpressionUUID->"3952e75f-65a1-4138-b683-588746f2220f"],
Cell[13721, 347, 480, 11, 60, "Output",ExpressionUUID->"5e3e2fe6-7916-49a1-9c39-2d10015689d5"]
}, Open  ]],
Cell[14216, 361, 692, 17, 28, "Input",ExpressionUUID->"0ec4b5cc-dd49-4204-8b91-7725f158e48a"],
Cell[14911, 380, 1218, 39, 28, "Input",ExpressionUUID->"364b73c5-59a3-49ea-ae34-16a424f75ec1"],
Cell[CellGroupData[{
Cell[16154, 423, 556, 10, 28, "Input",ExpressionUUID->"32fb6a70-894c-4fa9-a270-04beb4f39186"],
Cell[16713, 435, 1657, 40, 32, "Output",ExpressionUUID->"1f7e68b2-7b58-47a3-88e1-c7416ae5169b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18407, 480, 773, 17, 51, "Input",ExpressionUUID->"d0c5fc0d-376d-4437-a5a6-3147dfe1195a"],
Cell[19183, 499, 805, 16, 55, "Output",ExpressionUUID->"db86fab3-cd84-4838-8dc5-ce81f2dc5d1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20025, 520, 373, 9, 28, "Input",ExpressionUUID->"5c852bfc-8bdc-430c-945e-5e2cfcc11c78"],
Cell[20401, 531, 646, 14, 55, "Output",ExpressionUUID->"60e44220-9950-4895-aa2e-7e7f37b0f704"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21084, 550, 470, 9, 28, "Input",ExpressionUUID->"b073be11-f5b4-4681-82bb-5c849758f7c6"],
Cell[21557, 561, 510, 10, 55, "Output",ExpressionUUID->"8caabe53-5477-4c69-baea-f49bb159b9b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22104, 576, 1018, 27, 74, "Input",ExpressionUUID->"2d755497-6302-47ee-985f-241e652c6f37"],
Cell[23125, 605, 672, 14, 94, "Output",ExpressionUUID->"a9199d24-2e53-4e92-91d4-bb04147ff4ca"]
}, Open  ]]
}
]
*)

