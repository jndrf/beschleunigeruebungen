(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33007,        877]
NotebookOptionsPosition[     30803,        800]
NotebookOutlinePosition[     31141,        815]
CellTagsIndexPosition[     31098,        812]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Jonas Neundorf, Jan Skottke", "Text",
 CellChangeTimes->{{3.737872879871192*^9, 3.737872888289988*^9}}],

Cell[CellGroupData[{

Cell["Blatt 8 -- Raumladungsarbeitspunktverschiebung", "Title",
 CellChangeTimes->{{3.737872897476881*^9, 3.737872908560808*^9}}],

Cell["\<\
 Zun\[ADoubleDot]chst berechnen wir aus den Maxwell-Gleichungen in \
Integralform das elektrische Feld\
\>", "Text",
 CellChangeTimes->{{3.737830204418316*^9, 3.737830211906665*^9}, {
  3.7378729208010883`*^9, 3.737872949840952*^9}},
 ExpressionUUID -> "c214aab0-0597-482e-8408-04c5d3d8744f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]", "[", "r_", "]"}], ":=", 
  RowBox[{"e", "*", 
   SubscriptBox["n", "s"]}]}]], "Input",
 CellChangeTimes->{{3.737829650539524*^9, 3.7378296574424667`*^9}, 
   3.7378299370266724`*^9, {3.7378439894887595`*^9, 3.737843990175065*^9}},
 ExpressionUUID -> "78049c20-8945-4679-bba1-8d2e399af16d"],

Cell[BoxData[
 RowBox[{"lefte", ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"r", "*", "eField"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", 
        RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", "0", ",", "l"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7378293659244432`*^9, 3.7378294578914175`*^9}, 
   3.737830229875291*^9},
 ExpressionUUID -> "5e0a102c-8b27-4dad-9340-af32a9623496"],

Cell[BoxData[
 RowBox[{"righte", ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          SubscriptBox["\[Epsilon]", "0"]], "*", "r", "*", "\[Rho]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "0", ",", "l"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", 
        RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "0", ",", "r"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.737829464947204*^9, 3.7378295616344132`*^9}, {
   3.737829646324833*^9, 3.7378296473787684`*^9}, 3.7378302316025267`*^9, {
   3.737830332772683*^9, 3.7378303857804923`*^9}, {3.737831286998436*^9, 
   3.7378312874759474`*^9}, {3.7378435575548906`*^9, 3.7378435578395996`*^9}},
 
 ExpressionUUID -> "e22b6d79-046d-4a7c-ab61-757200158e38"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ef", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"lefte", "\[Equal]", "righte"}], ",", "eField"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.737829604915167*^9, 3.7378296127711353`*^9}, {
   3.737829663619153*^9, 3.7378296653164167`*^9}, {3.737829946643841*^9, 
   3.73782997320369*^9}, 3.7378301676988544`*^9, {3.7378302353307133`*^9, 
   3.737830236450568*^9}, {3.7378310902755504`*^9, 3.737831091523275*^9}, {
   3.7378313037962637`*^9, 3.7378313397005577`*^9}, {3.7378314679404645`*^9, 
   3.7378314694289427`*^9}},
 ExpressionUUID -> "938c221d-01e4-4f5d-a149-0eb3c3fd2894"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"eField", "\[Rule]", 
   FractionBox[
    RowBox[{"r", " ", "\[Rho]"}], 
    RowBox[{"2", " ", 
     SubscriptBox["\[Epsilon]", "0"]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.737829613023877*^9, {3.7378296612645597`*^9, 3.7378296685940666`*^9}, 
   3.7378299416579385`*^9, 3.737829974459404*^9, 3.7378301685539837`*^9, 
   3.737830243431432*^9, 3.7378304111395674`*^9, 3.7378310917560368`*^9, {
   3.7378312904459124`*^9, 3.7378312977604337`*^9}, {3.7378313429162703`*^9, 
   3.737831364500805*^9}, 3.737831475089156*^9, 3.7378315307452574`*^9, {
   3.7378329864986877`*^9, 3.737833006102646*^9}, 3.737835859891656*^9, 
   3.737836632026946*^9, 3.7378401007600546`*^9, 3.737840155475154*^9, 
   3.7378404931629276`*^9, 3.7378406933972454`*^9, {3.7378407317660203`*^9, 
   3.7378407508395367`*^9}, 3.7378409148342457`*^9, 3.737841724834612*^9, {
   3.737842340603098*^9, 3.737842362185034*^9}, {3.7378423940834236`*^9, 
   3.7378424196423116`*^9}, 3.7378426909998794`*^9, 3.7378429175087695`*^9, 
   3.7378431820293446`*^9, 3.7378436704754677`*^9, 3.737843717287465*^9, 
   3.7378439944003925`*^9, 3.7378440738769383`*^9, 3.737874042210943*^9, 
   3.7378744487702923`*^9, 3.737874482093029*^9, 3.7378862786744556`*^9},
 ExpressionUUID -> "ed9259ab-6c00-43c0-8dc4-2b8d15c0cbd8"]
}, Open  ]],

Cell["und das Magnetfeld.", "Text",
 CellChangeTimes->{{3.7378302171702814`*^9, 3.7378302200823092`*^9}, {
  3.737872953705597*^9, 3.737872957097128*^9}},
 ExpressionUUID -> "63b32c19-ee8e-4af9-98bf-5467c1c501bc"],

Cell[BoxData[
 RowBox[{"leftb", ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"r", "*", "bField"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "0", ",", 
      RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.737830246195608*^9, 3.7378302941951227`*^9}},
 ExpressionUUID -> "e415a441-25e4-4518-9242-78e65170e5f9"],

Cell[BoxData[
 RowBox[{"rightb", ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "0"], "*", "r", "*", "j"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", 
        RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "0", ",", "r"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7378302972050576`*^9, 3.7378303042758327`*^9}, {
  3.737830416195399*^9, 3.737830423507923*^9}, {3.7378305997157917`*^9, 
  3.737830651602747*^9}, {3.737843591025674*^9, 3.737843591295397*^9}},
 ExpressionUUID -> "30272dab-b1c9-426f-92b9-fbaf4958b4e2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bf", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"leftb", "\[Equal]", "rightb"}], ",", "bField"}], "]"}], "//.", 
     RowBox[{"j", "\[Rule]", " ", 
      RowBox[{"\[Rho]", "*", "\[Beta]", "*", "c"}]}]}], "//.", 
    RowBox[{
     SubscriptBox["\[Mu]", "0"], "\[Rule]", " ", 
     FractionBox["1", 
      RowBox[{
       SubscriptBox["\[Epsilon]", "0"], "*", 
       SuperscriptBox["c", "2"]}]]}]}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.7378307531239595`*^9, 3.7378307686440926`*^9}, {
   3.7378309427723465`*^9, 3.7378309613463774`*^9}, {3.737830999540311*^9, 
   3.737831001012806*^9}, {3.7378310986439953`*^9, 3.737831099107521*^9}, {
   3.7378312933489437`*^9, 3.7378312939713073`*^9}, 3.7378313595262995`*^9, 
   3.737831465428033*^9, {3.737831513684699*^9, 3.7378315268522377`*^9}, {
   3.7378435669772577`*^9, 3.73784357958337*^9}},
 ExpressionUUID -> "162167b6-f220-40e0-bc58-9d2031b8b37e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"bField", "\[Rule]", 
   FractionBox[
    RowBox[{"r", " ", "\[Beta]", " ", "\[Rho]"}], 
    RowBox[{"2", " ", "c", " ", 
     SubscriptBox["\[Epsilon]", "0"]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.737830769233491*^9, 3.737830961799894*^9, 3.7378310012445683`*^9, 
   3.7378310996899376`*^9, 3.7378312977943993`*^9, {3.737831360271538*^9, 
   3.7378313645527515`*^9}, 3.7378314751281166`*^9, 3.737831530783219*^9, {
   3.737832986537648*^9, 3.737833006172575*^9}, 3.737835859927619*^9, 
   3.7378366320629096`*^9, 3.737840100799014*^9, 3.7378401555171056`*^9, 
   3.7378404931978874`*^9, 3.7378406934392166`*^9, {3.7378407318109865`*^9, 
   3.7378407508834753`*^9}, 3.737840914875204*^9, 3.737841724878579*^9, {
   3.737842340650049*^9, 3.737842362219999*^9}, {3.7378423941184034`*^9, 
   3.7378424196832523`*^9}, 3.7378426910358424`*^9, 3.7378429175567303`*^9, 
   3.7378431820673122`*^9, 3.7378436705234003`*^9, 3.7378437173344293`*^9, 
   3.737843994437355*^9, 3.7378440739158697`*^9, 3.73787404240841*^9, 
   3.737874448886022*^9, 3.737874482175261*^9, 3.7378862787824*^9},
 ExpressionUUID -> "8a96e08c-96e6-4b32-8329-3969d46de20f"]
}, Open  ]],

Cell["\<\
Damit l\[ADoubleDot]sst sich nun ein Ausdruck f\[UDoubleDot]r die \
Lorentzkraft aufstellen0\
\>", "Text",
 CellChangeTimes->{{3.7378330158117228`*^9, 3.7378330193481073`*^9}, {
  3.737872963848877*^9, 3.737872984137122*^9}},
 ExpressionUUID -> "cd4ce4f6-648f-4779-a44c-9be28e30d54a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fLorentz", "[", "r_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"e", "*", 
    RowBox[{"(", 
     RowBox[{"eField", "+", 
      RowBox[{"\[Beta]", "*", "c", "*", "bField"}]}], ")"}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.7378310323887434`*^9, 3.7378311125018277`*^9}, {
  3.737831196116347*^9, 3.7378311970114374`*^9}, {3.737831375508551*^9, 
  3.737831377763246*^9}, {3.7378314421659937`*^9, 3.7378314422608967`*^9}},
 ExpressionUUID -> "eb143888-9ca1-4e8a-86eb-eaaa34c2c616"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fLorentz", "[", "r", "]"}], "//.", "ef"}], "//.", "bf"}], "//.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Beta]", "2"]}], ")"}], "\[Rule]", " ", 
    FractionBox["1", 
     SuperscriptBox["\[Gamma]", "2"]]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7378311139083896`*^9, 3.737831133524336*^9}, {
  3.737831168308775*^9, 3.737831209461704*^9}, {3.7378329643413377`*^9, 
  3.737832977732647*^9}},
 ExpressionUUID -> "8d5b0347-71cf-4a25-b401-fea3ecdb0a38"],

Cell[BoxData[
 FractionBox[
  RowBox[{"e", " ", "r", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[Beta]", "2"]}], ")"}], " ", "\[Rho]"}], 
  RowBox[{"2", " ", 
   SubscriptBox["\[Epsilon]", "0"]}]]], "Output",
 CellChangeTimes->{{3.737831117453765*^9, 3.7378311337511044`*^9}, {
   3.737831169989057*^9, 3.7378312097224503`*^9}, 3.7378312978533382`*^9, {
   3.737831364623679*^9, 3.7378313793076696`*^9}, 3.737831443496634*^9, 
   3.73783147518306*^9, 3.737831530846154*^9, {3.7378329802860374`*^9, 
   3.7378330062345114`*^9}, 3.737835859995549*^9, 3.737836632138832*^9, 
   3.737840100871956*^9, 3.73784015559103*^9, 3.7378404932728024`*^9, 
   3.737840693511167*^9, {3.7378407318709507`*^9, 3.7378407509464245`*^9}, 
   3.7378409149611173`*^9, 3.7378417249365115`*^9, {3.737842340710989*^9, 
   3.737842362294958*^9}, {3.737842394186318*^9, 3.737842419750184*^9}, 
   3.737842691108796*^9, 3.7378429176296577`*^9, 3.737843182146224*^9, 
   3.737843670585338*^9, 3.7378437174051085`*^9, 3.737843994511279*^9, 
   3.737844073977807*^9, 3.737874042531925*^9, 3.73787444903277*^9, 
   3.737874482253647*^9, 3.737886278888763*^9},
 ExpressionUUID -> "12fae661-18e6-4eba-9797-71ff42b85e44"]
}, Open  ]],

Cell["\<\
und die Quadrupolst\[ADoubleDot]rke des selbsterzeugten Magnetfeldes \
berechnen. Anders als beim Quadrupol erzeugt der Strahl auch ein elektrisches \
Feld, das ihn beeinflusst. Wir m\[UDoubleDot]ssen also beide Felder bei der \
Berechnugn des Gradienten g ber\[UDoubleDot]cksichtigen.\
\>", "Text",
 CellChangeTimes->{{3.7378348430490637`*^9, 3.7378348650945153`*^9}, {
  3.737872990121044*^9, 3.7378730119451723`*^9}, {3.7378743214226*^9, 
  3.737874385158181*^9}},
 ExpressionUUID -> "d685a21e-3c04-4851-b75d-f2c45103365b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"-", "1"}], 
     RowBox[{"e", "*", "c", "*", "\[Beta]"}]], 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"fLorentz", "[", "r", "]"}], " ", "//.", "bf"}], " ", "//.", 
       "ef"}], ",", " ", "r"}], "]"}]}], " ", "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.73778414963698*^9, 3.737784194912979*^9}, {
  3.737825123472046*^9, 3.73782514223886*^9}, {3.7378423319349594`*^9, 
  3.73784235815915*^9}, {3.737874027396472*^9, 3.73787409864191*^9}, {
  3.73787416725043*^9, 3.737874191811854*^9}},
 ExpressionUUID -> "3dd5765b-5d33-4f09-a9f4-de94037d8093"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Beta]", "2"]}], ")"}], " ", "\[Rho]"}], 
   RowBox[{"2", " ", "c", " ", "\[Beta]", " ", 
    SubscriptBox["\[Epsilon]", "0"]}]]}]], "Output",
 CellChangeTimes->{{3.7378423407269707`*^9, 3.737842362311921*^9}, {
   3.73784239420431*^9, 3.7378424197661777`*^9}, 3.7378426911287475`*^9, 
   3.737842917648631*^9, 3.7378431821642065`*^9, 3.737843670602332*^9, 
   3.737843717420105*^9, 3.7378439945312586`*^9, 3.7378440739937906`*^9, 
   3.7378740425468397`*^9, {3.737874073194394*^9, 3.737874100092558*^9}, {
   3.737874171030262*^9, 3.7378741950717783`*^9}, 3.7378744491345043`*^9, 
   3.737874482332057*^9, 3.737886278918539*^9},
 ExpressionUUID -> "e984765f-31e4-4569-bc33-82467cdcc645"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"k", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"e", "*", "c"}], 
      RowBox[{"\[Beta]", "*", "energy"}]], "*", "g"}], "//.", 
    RowBox[{"energy", "\[Rule]", " ", 
     RowBox[{"m0", "*", 
      SuperscriptBox["c", "2"], "*", "\[Gamma]"}]}]}], " ", "//.", 
   RowBox[{"\[Rho]", "\[Rule]", 
    FractionBox["i", 
     RowBox[{"\[Pi]", "*", 
      SuperscriptBox["a", "2"], "*", "\[Beta]", "*", "c"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.737784204877008*^9, 3.7377842182814813`*^9}, {
   3.7377845643140774`*^9, 3.737784577801609*^9}, {3.7378426173611617`*^9, 
   3.7378426252311163`*^9}, {3.737842672095206*^9, 3.7378426778243494`*^9}, {
   3.7378429114249887`*^9, 3.737842911598811*^9}, {3.737843523041175*^9, 
   3.7378435231360784`*^9}, 3.737874291672658*^9, {3.737886238821981*^9, 
   3.737886257930969*^9}},
 ExpressionUUID -> "575a26d0-52d2-4558-b672-5ab5ad29ca8f"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"e", " ", "i", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Beta]", "2"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox["c", "3"], " ", "m0", " ", "\[Pi]", " ", 
    SuperscriptBox["\[Beta]", "3"], " ", "\[Gamma]", " ", 
    SubscriptBox["\[Epsilon]", "0"]}]]}]], "Output",
 CellChangeTimes->{{3.7378423407559414`*^9, 3.737842362339881*^9}, {
   3.7378423942322717`*^9, 3.7378424197831607`*^9}, {3.7378426793308086`*^9, 
   3.7378426911457305`*^9}, 3.737842917667617*^9, 3.7378431821831865`*^9, 
   3.737843525273909*^9, 3.737843670626295*^9, 3.7378437174430842`*^9, 
   3.7378439945522366`*^9, 3.7378440740127707`*^9, 3.7378740426298532`*^9, 
   3.737874106948257*^9, 3.737874197474462*^9, 3.7378744492735157`*^9, 
   3.737874482337946*^9, 3.7378862789652777`*^9},
 ExpressionUUID -> "4be76f44-6c19-43db-a110-6530d5e98034"]
}, Open  ]],

Cell["Betrachten wir nun die Auswirkungen w\[ADoubleDot]hrend eines \
Umlaufes", "Text",
 CellChangeTimes->{{3.737873019218337*^9, 3.737873038588182*^9}, {
  3.737873112357079*^9, 3.737873117857789*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mQ", "[", "l_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "0"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"k", "*", "l"}], ")"}]}], ",", " ", "1"}], "}"}]}], "}"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.7377851097466145`*^9, 3.737785162701046*^9}, {
   3.7378361534165783`*^9, 3.737836156568362*^9}, {3.737840485725514*^9, 
   3.7378404873568463`*^9}, 3.7378406887809772`*^9, {3.7378407453741083`*^9, 
   3.7378407455659122`*^9}, 3.737842318767421*^9},
 ExpressionUUID -> "0ec4b5cc-dd49-4204-8b91-7725f158e48a"],

Cell[BoxData[
 RowBox[{"twissMat", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Mu]", 
      RowBox[{"ph", ",", "0"}]], "]"}], "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "0"}], "}"}], 
      StyleBox[",",
       FontWeight->"Plain"], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      StyleBox[
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "1"}], "}"}],
       FontWeight->"Plain"]}], 
     StyleBox["}",
      FontWeight->"Plain"]}]}], 
   StyleBox[" ",
    FontWeight->"Plain"], 
   StyleBox["+",
    FontWeight->"Plain"], 
   StyleBox[" ",
    FontWeight->"Plain"], 
   RowBox[{
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Mu]", 
      RowBox[{"ph", ",", "0"}]], "]"}], "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", " ", 
        SubscriptBox["\[Beta]", "t"]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["\[Gamma]", "t"]}], ",", " ", 
        RowBox[{"-", "\[Alpha]"}]}], "}"}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7378349248404465`*^9, 3.737834944983843*^9}, {
  3.737840896366126*^9, 3.737840903549782*^9}, {3.7378423829587965`*^9, 
  3.7378423894221888`*^9}, {3.737843623393592*^9, 3.73784364471978*^9}},
 ExpressionUUID -> "364b73c5-59a3-49ea-ae34-16a424f75ec1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"disturbedMat", "=", 
  RowBox[{
   RowBox[{"twissMat", ".", 
    RowBox[{"mQ", "[", "ds", "]"}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.73783503944827*^9, 3.737835042230425*^9}, {
  3.737835076902979*^9, 3.737835101448885*^9}, {3.7378351324881535`*^9, 
  3.7378351327908435`*^9}, {3.7378362189695625`*^9, 3.7378362288244877`*^9}, {
  3.7378407687166376`*^9, 3.737840803180397*^9}, {3.737840907422823*^9, 
  3.7378409078693657`*^9}},
 ExpressionUUID -> "32fb6a70-894c-4fa9-a270-04beb4f39186"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Mu]", 
        RowBox[{"ph", ",", "0"}]], "]"}], "+", 
      RowBox[{"\[Alpha]", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Mu]", 
         RowBox[{"ph", ",", "0"}]], "]"}]}], "+", 
      FractionBox[
       RowBox[{"ds", " ", "e", " ", "i", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[Beta]", "2"]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Mu]", 
          RowBox[{"ph", ",", "0"}]], "]"}], " ", 
        SubscriptBox["\[Beta]", "t"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["c", "3"], " ", "m0", " ", "\[Pi]", " ", 
        SuperscriptBox["\[Beta]", "3"], " ", "\[Gamma]", " ", 
        SubscriptBox["\[Epsilon]", "0"]}]]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Mu]", 
        RowBox[{"ph", ",", "0"}]], "]"}], " ", 
      SubscriptBox["\[Beta]", "t"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Mu]", 
          RowBox[{"ph", ",", "0"}]], "]"}]}], " ", 
       SubscriptBox["\[Gamma]", "t"]}], "+", 
      FractionBox[
       RowBox[{"ds", " ", "e", " ", "i", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[Beta]", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Mu]", 
            RowBox[{"ph", ",", "0"}]], "]"}], "-", 
          RowBox[{"\[Alpha]", " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Mu]", 
             RowBox[{"ph", ",", "0"}]], "]"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["c", "3"], " ", "m0", " ", "\[Pi]", " ", 
        SuperscriptBox["\[Beta]", "3"], " ", "\[Gamma]", " ", 
        SubscriptBox["\[Epsilon]", "0"]}]]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Mu]", 
        RowBox[{"ph", ",", "0"}]], "]"}], "-", 
      RowBox[{"\[Alpha]", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Mu]", 
         RowBox[{"ph", ",", "0"}]], "]"}]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7378350940644464`*^9, 3.737835101644685*^9}, 
   3.7378351336819324`*^9, 3.7378358600504932`*^9, 3.7378361588350563`*^9, {
   3.7378362205789185`*^9, 3.7378362304158773`*^9}, 3.7378366321757936`*^9, 
   3.737840100946863*^9, 3.7378401556779413`*^9, 3.737840493350729*^9, 
   3.737840693584055*^9, {3.737840731911871*^9, 3.737840803415152*^9}, 
   3.737840915085988*^9, 3.737841725058395*^9, {3.7378423417768974`*^9, 
   3.737842363041174*^9}, {3.737842394695797*^9, 3.737842420253669*^9}, 
   3.7378426920098624`*^9, 3.737842917804467*^9, 3.737843182328038*^9, 
   3.7378436707921257`*^9, 3.7378437176089144`*^9, 3.7378439947150707`*^9, 
   3.737844074184595*^9, 3.7378740430149603`*^9, 3.7378744514345417`*^9, 
   3.7378744845287533`*^9, 3.737886281772128*^9},
 ExpressionUUID -> "cbc8ce3f-dcc9-4ac0-8869-d543669feb41"]
}, Open  ]],

Cell["Der Phasenvorschub \[ADoubleDot]ndert sich um eine kleine Zahl \[Delta]\
\[Mu]", "Text",
 CellChangeTimes->{{3.737873122060413*^9, 3.737873153281559*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Mu]", "ph"], "]"}], "\[Equal]", 
     RowBox[{
      FractionBox["1", "2"], "*", 
      RowBox[{"Tr", "[", "disturbedMat", "]"}]}]}], "//.", 
    RowBox[{
     SubscriptBox["\[Mu]", "ph"], "\[Rule]", " ", 
     RowBox[{"\[Delta]\[Mu]", "+", 
      SubscriptBox["\[Mu]", 
       RowBox[{"ph", ",", "0"}]]}]}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.7378408331667356`*^9, 3.73784086279646*^9}, {
   3.737840920510458*^9, 3.7378409280767097`*^9}, {3.737840998702505*^9, 
   3.7378410065115223`*^9}, {3.7378410506863613`*^9, 3.7378410736289234`*^9}, 
   3.7378412036469855`*^9, 3.7378415350232124`*^9, {3.7378419311516895`*^9, 
   3.7378419400945473`*^9}, {3.737843650337037*^9, 3.73784366188723*^9}},
 ExpressionUUID -> "d0c5fc0d-376d-4437-a5a6-3147dfe1195a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cos", "[", 
   RowBox[{"\[Delta]\[Mu]", "+", 
    SubscriptBox["\[Mu]", 
     RowBox[{"ph", ",", "0"}]]}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Mu]", 
     RowBox[{"ph", ",", "0"}]], "]"}], "+", 
   FractionBox[
    RowBox[{"ds", " ", "e", " ", "i", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[Beta]", "2"]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Mu]", 
       RowBox[{"ph", ",", "0"}]], "]"}], " ", 
     SubscriptBox["\[Beta]", "t"]}], 
    RowBox[{"4", " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox["c", "3"], " ", "m0", " ", "\[Pi]", " ", 
     SuperscriptBox["\[Beta]", "3"], " ", "\[Gamma]", " ", 
     SubscriptBox["\[Epsilon]", "0"]}]]}]}]], "Output",
 CellChangeTimes->{
  3.7378408658173676`*^9, {3.737840915100973*^9, 3.7378409287580256`*^9}, 
   3.737841006782257*^9, {3.737841063588171*^9, 3.7378410741064315`*^9}, 
   3.7378412162520995`*^9, 3.7378415354078197`*^9, 3.7378417251952553`*^9, 
   3.7378419404341993`*^9, {3.737842348236294*^9, 3.737842420835087*^9}, 
   3.737842699080618*^9, 3.7378429179722953`*^9, 3.7378431824908886`*^9, 
   3.7378436709609528`*^9, 3.7378437177797565`*^9, 3.7378439948809013`*^9, 
   3.73784407435542*^9, 3.737874043442273*^9, 3.737874454388332*^9, 
   3.737874487255266*^9, 3.737886285802147*^9},
 ExpressionUUID -> "1cb5cd02-64bb-472a-ae9b-548eb49750f8"]
}, Open  ]],

Cell["\<\
Wir k\[ODoubleDot]nnen nun eine Reihenentwicklung um \[Delta]\[Mu] machen. Da \
die Phasenvorschubsverschiebung pro Umlauf klein sein sollte, reicht es, die \
Entwicklung nur bis zum linearen Term durchzuf\[UDoubleDot]hren.\
\>", "Text",
 CellChangeTimes->{{3.737873206312725*^9, 3.737873238746642*^9}, {
  3.737873349157251*^9, 3.7378733972908583`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{"eq", ",", 
     RowBox[{"{", 
      RowBox[{"\[Delta]\[Mu]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Normal"}]}]], "Input",
 CellChangeTimes->{{3.7378419439676037`*^9, 3.7378420378705883`*^9}},
 ExpressionUUID -> "5c852bfc-8bdc-430c-945e-5e2cfcc11c78"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Mu]", 
     RowBox[{"ph", ",", "0"}]], "]"}], "-", 
   RowBox[{"\[Delta]\[Mu]", " ", 
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Mu]", 
      RowBox[{"ph", ",", "0"}]], "]"}]}]}], "\[Equal]", 
  RowBox[{
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Mu]", 
     RowBox[{"ph", ",", "0"}]], "]"}], "+", 
   FractionBox[
    RowBox[{"ds", " ", "e", " ", "i", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[Beta]", "2"]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Mu]", 
       RowBox[{"ph", ",", "0"}]], "]"}], " ", 
     SubscriptBox["\[Beta]", "t"]}], 
    RowBox[{"4", " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox["c", "3"], " ", "m0", " ", "\[Pi]", " ", 
     SuperscriptBox["\[Beta]", "3"], " ", "\[Gamma]", " ", 
     SubscriptBox["\[Epsilon]", "0"]}]]}]}]], "Output",
 CellChangeTimes->{{3.737841959116101*^9, 3.7378420383281336`*^9}, {
   3.737842348374153*^9, 3.737842420920005*^9}, 3.737842699213482*^9, 
   3.737842918029254*^9, 3.737843182550811*^9, 3.737843671010902*^9, 
   3.7378437178341317`*^9, 3.737843994934846*^9, 3.7378440743963795`*^9, 
   3.737874043748898*^9, 3.737874454652467*^9, 3.7378744874543543`*^9, 
   3.737886285960437*^9},
 ExpressionUUID -> "0d5f34d8-721a-42dc-a2ec-c691ee7fbe7e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phaseshift", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{"solution", ",", "\[Delta]\[Mu]"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.737842040430971*^9, 3.737842046798461*^9}, {
  3.7378421074714427`*^9, 3.7378421383838315`*^9}, {3.7378431268647404`*^9, 
  3.7378431322082853`*^9}, {3.7378431693433228`*^9, 3.7378431733452387`*^9}},
 ExpressionUUID -> "b073be11-f5b4-4681-82bb-5c849758f7c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Delta]\[Mu]", "\[Rule]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"ds", " ", "e", " ", "i", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Beta]", "2"]}], ")"}], " ", 
      SubscriptBox["\[Beta]", "t"]}], 
     RowBox[{"4", " ", 
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["c", "3"], " ", "m0", " ", "\[Pi]", " ", 
      SuperscriptBox["\[Beta]", "3"], " ", "\[Gamma]", " ", 
      SubscriptBox["\[Epsilon]", "0"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7378420474457994`*^9, {3.7378421118439646`*^9, 3.737842138563659*^9}, {
   3.7378423483941326`*^9, 3.737842420940966*^9}, 3.7378426992324624`*^9, 
   3.7378429180482283`*^9, 3.73784313253794*^9, 3.737843182570791*^9, 
   3.7378436710319095`*^9, 3.7378437178521185`*^9, 3.73784399495083*^9, 
   3.737844074420354*^9, 3.737874043843997*^9, 3.7378744547338037`*^9, 
   3.73787448753559*^9, 3.7378862860129623`*^9},
 ExpressionUUID -> "15b360b8-3e95-4627-a8ae-275f69b48570"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tuneshift", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["\[Delta]\[Mu]", 
          RowBox[{"2", "*", "Pi"}]], "//.", "phaseshift"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "0", ",", "l"}], "}"}]}], "]"}], "//.", 
      RowBox[{"ds", "\[Rule]", " ", "1"}]}], "//.", 
     RowBox[{"a", "\[Rule]", 
      RowBox[{"Sqrt", "[", " ", 
       RowBox[{
        SubscriptBox["\[Epsilon]", "t"], "*", 
        SubscriptBox["\[Beta]", "t"]}], "]"}]}]}], "//.", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "t"], "\[Rule]", " ", 
     FractionBox[
      SubscriptBox["\[Epsilon]", "n"], 
      RowBox[{"\[Beta]", "*", "\[Gamma]"}]]}]}], "//.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Beta]", "2"]}], ")"}], "\[Rule]", 
    FractionBox["1", 
     SuperscriptBox["\[Gamma]", "2"]]}]}]}]], "Input",
 CellChangeTimes->{{3.7378421417274227`*^9, 3.737842196095831*^9}, {
  3.7378422394555035`*^9, 3.73784225783871*^9}, {3.7378431643534145`*^9, 
  3.737843272207158*^9}, {3.7378433872170305`*^9, 3.7378434260822983`*^9}, {
  3.737874304854443*^9, 3.737874309733067*^9}, {3.737886293805389*^9, 
  3.737886314724324*^9}},
 ExpressionUUID -> "2d755497-6302-47ee-985f-241e652c6f37"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"e", " ", "i", " ", "l"}], 
   RowBox[{"8", " ", 
    SuperscriptBox["c", "3"], " ", "m0", " ", 
    SuperscriptBox["\[Pi]", "2"], " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    SuperscriptBox["\[Gamma]", "2"], " ", 
    SubscriptBox["\[Epsilon]", "0"], " ", 
    SubscriptBox["\[Epsilon]", "n"]}]]}]], "Output",
 CellChangeTimes->{
  3.737842239897052*^9, {3.737842348411115*^9, 3.7378424209549646`*^9}, 
   3.737842699247448*^9, 3.7378429180632124`*^9, {3.737843164840933*^9, 
   3.7378432155271034`*^9}, {3.7378432497111564`*^9, 3.7378432726447115`*^9}, 
   3.7378434268375263`*^9, 3.7378436710478673`*^9, 3.7378437178691006`*^9, 
   3.7378439949698105`*^9, 3.737844074439335*^9, 3.737874043956511*^9, 
   3.737874454827353*^9, 3.7378744876533012`*^9, {3.737886286068644*^9, 
   3.737886315893045*^9}},
 ExpressionUUID -> "b1ad0279-7e3b-4be8-8f08-9523f839900a"]
}, Open  ]],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.7378740474569197`*^9}],

Cell["Einsetzen der Teilchenzahl", "Text",
 CellChangeTimes->{{3.737886348486932*^9, 3.7378863619562387`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tuneshiftN", "=", " ", 
  RowBox[{"tuneshift", " ", "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"i", "\[Rule]", 
      FractionBox["charge", "time"]}], ",", " ", 
     RowBox[{"charge", "\[Rule]", 
      RowBox[{"e", "*", "n"}]}], ",", " ", 
     RowBox[{"time", " ", "\[Rule]", " ", 
      FractionBox[
       RowBox[{"\[Pi]", "*", "2", "*", "R"}], 
       RowBox[{"\[Beta]", "*", "c"}]]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.737886365558967*^9, 3.737886437752305*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["e", "2"], " ", "l", " ", "n"}], 
   RowBox[{"16", " ", 
    SuperscriptBox["c", "2"], " ", "m0", " ", 
    SuperscriptBox["\[Pi]", "3"], " ", "R", " ", "\[Beta]", " ", 
    SuperscriptBox["\[Gamma]", "2"], " ", 
    SubscriptBox["\[Epsilon]", "0"], " ", 
    SubscriptBox["\[Epsilon]", "n"]}]]}]], "Output",
 CellChangeTimes->{3.7378864397640944`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{928, 1148},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 109, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[692, 25, 129, 1, 150, "Title"],
Cell[824, 28, 302, 6, 33, "Text"],
Cell[1129, 36, 333, 7, 34, "Input"],
Cell[1465, 45, 526, 14, 34, "Input"],
Cell[1994, 61, 947, 23, 56, "Input"],
Cell[CellGroupData[{
Cell[2966, 88, 649, 13, 34, "Input"],
Cell[3618, 103, 1321, 22, 50, "Output"]
}, Open  ]],
Cell[4954, 128, 213, 3, 33, "Text"],
Cell[5170, 133, 365, 9, 34, "Input"],
Cell[5538, 144, 683, 16, 34, "Input"],
Cell[CellGroupData[{
Cell[6246, 164, 994, 22, 57, "Input"],
Cell[7243, 188, 1184, 20, 51, "Output"]
}, Open  ]],
Cell[8442, 211, 294, 6, 33, "Text"],
Cell[8739, 219, 520, 12, 34, "Input"],
Cell[CellGroupData[{
Cell[9284, 235, 583, 15, 56, "Input"],
Cell[9870, 252, 1211, 21, 59, "Output"]
}, Open  ]],
Cell[11096, 276, 536, 9, 77, "Text"],
Cell[CellGroupData[{
Cell[11657, 289, 699, 18, 55, "Input"],
Cell[12359, 309, 809, 16, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13205, 330, 941, 21, 57, "Input"],
Cell[14149, 353, 949, 19, 60, "Output"]
}, Open  ]],
Cell[15113, 375, 203, 3, 33, "Text"],
Cell[15319, 380, 672, 17, 34, "Input"],
Cell[15994, 399, 1376, 44, 36, "Input"],
Cell[CellGroupData[{
Cell[17395, 447, 536, 10, 32, "Input"],
Cell[17934, 459, 3181, 79, 113, "Output"]
}, Open  ]],
Cell[21130, 541, 160, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[21315, 547, 901, 20, 53, "Input"],
Cell[22219, 569, 1449, 33, 60, "Output"]
}, Open  ]],
Cell[23683, 605, 364, 6, 55, "Text"],
Cell[CellGroupData[{
Cell[24072, 615, 353, 9, 34, "Input"],
Cell[24428, 626, 1358, 34, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25823, 665, 450, 9, 34, "Input"],
Cell[26276, 676, 1031, 22, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27344, 703, 1339, 35, 123, "Input"],
Cell[28686, 740, 924, 19, 53, "Output"]
}, Open  ]],
Cell[29625, 762, 71, 1, 32, "Input"],
Cell[29699, 765, 110, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[29834, 770, 511, 13, 56, "Input"],
Cell[30348, 785, 427, 11, 90, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

